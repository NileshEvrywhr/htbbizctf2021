# notes

- office file are mostly contain XML
- macros - VBA(Visual Basic for Applications) Script
- word documents are archives
- UPDATE: all office file are archives
- ppt's are glorified for some reason :P
- zip file containers is a better term

## compound documents
- combines multiple streams, by reference or inclusion
- often generated by word processing software

## oletools
- python module to read MS OLE(Object Linking and Embedding)2 files

## olevba
- olevba is a script to parse OLE and OpenXML files
- extract macros from office file

- files are (heavily?)obfuscated
- meaning redundant code that does nothing
- remove them to get a clear idea of what the VBScript is doing

## functions used
- ChrW: converts ascii code to characters
- UBound: upper bound

## layer1.py
converts the 2 images in docm into the VBScript payload; ascii code to char > bytes > str

## layer2.py
converts VBScript into obsfuscated powershell script; ascii code to char > bytes > str

> use powershell in kali for deobsfucation
